//@version=5
indicator("XL Sector", overlay=true)

//  Manual GICS Overrides (Ticker → SPDR Sector)
gicsOverride = switch syminfo.ticker
    "AAPL" => "XLK"   
    "AFRM" => "XLK"
    "AUDC" => "XLK"
    "AVNW" => "XLK"
    "VRSN" => "XLK"
    "ATER" => "XLK"
    "RPRX" => "XLV"  
    "AMR"  => "XLB"
    "SHW"  => "XLB"
    "MTA"  => "XLB"
    "AVTR" => "XLB"
    "IE"   => "XLB"
    "ATVI" => "XLC"
    "APOG" => "XLY"
    "ATOM" => "XLP"
    "ARCE" => "XLP"
    "AGRO" => "XLP"
    "TSLA" => "XLY"
    "AMTX" => "XLE"

    "SPY" => "ETF"
    "QQQ" => "ETF"
    "DJI" => "ETF"
    "IWM" => "ETF"
    "GLD" => "ETF"
    "SLV" => "ETF"

    "XLF" => "ETF"
    "XLE" => "ETF"
    "XLC" => "ETF"
    "XLB" => "ETF"
    "XLRE" => "ETF"
    "XLP" => "ETF"
    "XLK" => "ETF"
    "XLI" => "ETF"
    "XLY" => "ETF"
    "XLV" => "ETF"
    "XLU" => "ETF"
    => ""


// Industry → SPDR Sector Mapping
_industry = syminfo.industry

_spdr_industry = switch _industry
    "Semiconductors"                    => "XLK"
    "Computer Communications"           => "XLK"
    "Electronics/Appliances"            => "XLK"
    "Software"                          => "XLK"
    "Information Technology Services"   => "XLK"
    "Other Transportation"              => "XLK"
    "Computer Peripherals"              => "XLK"
    "Computer Processing Hardware"      => "XLK"    
    "Electronic Components"             => "XLK"
    "Electronics Distributors"          => "XLK"
    "Packaged Software"                 => "XLK"
    "Data Processing Services"          => "XLK"

    "Telecommunications"                => "XLC"
    "Specialty Telecommunications"      => "XLC"
    "Telecommunications Equipment"      => "XLC"
    "Cable/Satellite TV"                => "XLC"
    "Media"                             => "XLC"
    "Media Conglomerates"               => "XLC"
    "Commercial Printing/Forms"         => "XLC"
    "Movies/Entertainment"              => "XLC"
    "Major Telecommunications"          => "XLC"
    "Broadcasting"                      => "XLC"
    "Publishings: Newspapers"           => "XLC"
    "Advertising/Marketing Services"    => "XLC"
    "Publishing: Newspapers"            => "XLC"
    "Interactive Media"                 => "XLC"
    "Publishing: Books/Magazines"       => "XLC"
    "Internet Software/Services"        => "XLC"
    "Wireless Telecommunications"       => "XLC"
    "Hotels/Resorts/Cruise lines"       => "XLC"

    "Biotechnology"                     => "XLV"
    "Pharmaceuticals"                   => "XLV"
    "Medical Specialties"               => "XLV"
    "Healthcare Services"               => "XLV"
    "Managed Health Care"               => "XLV"
    "Hospital/Nursing Management"       => "XLV"
    "Pharmaceuticals: Major"            => "XLV"
    "Services to the Health Industry"   => "XLV"
    "Engineering & Construction"        => "XLV"
    "Pharmaceuticals: Generic"          => "XLV"
    "Pharmaceuticals: Other"            => "XLV"
    "Drugstore Chains"                  => "XLV"
    "Medical Distributors"              => "XLV"
    "Personnel Services"                => "XLV"
    "Medical/Nursing Services"          => "XLV"

    "Retail"                            => "XLY"
    "Specialty Stores"                  => "XLY"
    "Autos"                             => "XLY"
    "Recreational Products"             => "XLY"
    "Casinos/Gaming"                    => "XLY"
    "Building Products"                 => "XLY"
    "Electronics/Appliance Stores"      => "XLY"
    "Homebuilding"                      => "XLY"
    "Home Improvement Chains"           => "XLY"
    "Apparel/Footwear"                  => "XLY"
    "Automotive Aftermarket"            => "XLY"
    "Auto Parts: OEM"                   => "XLY"
    "Apparel/Footwear Retail"           => "XLY"
    "Department Stores"                 => "XLY"
    "Restaurants"                       => "XLY"
    "Home Furnishings"                  => "XLY"
    "Consumer Durables"                 => "XLY"
    "Internet Retail"                   => "XLY"
    "Catalog/Specialty Distribution"    => "XLY"
    "Textiles"                          => "XLY"
    "Containers/Packaging"              => "XLY"
    "Hotels/Entertainment"              => "XLY"

    "Food Products"                     => "XLP"
    "Beverages"                         => "XLP"
    "Beverages: Non-Alcoholic"          => "XLP"
    ""
    "Food: Major Diversified"           => "XLP"
    "Food: Meat/Fish/Dairy"             => "XLP"
    "Beverages: Alcoholic"              => "XLP"
    "Food Distributors"                 => "XLP"
    "Agricultural Commodities/Milling"  => "XLP"
    "Food Retail"                       => "XLP"
    "Discount Stores"                   => "XLP"
    "Tobacco"                           => "XLP"
    "Miscellaneous Commercial Services" => "XLP"
    "Other Consumer Services"           => "XLP"
    "Household/Personal Care"           => "XLP"

    "Banks"                             => "XLF"
    "Insurance"                         => "XLF"
    "Financial Conglomerates"           => "XLF"
    "Investment Banks/Brokers"          => "XLF"
    "Multi-Line Insurance"              => "XLF"
    "Regional Banks"                    => "XLF"
    "Life/Health Insurance"             => "XLF"
    "Financial Publishing/Services"     => "XLF"
    "Investment Management"             => "XLF"
    "Major Banks"                       => "XLF"
    "Investment Managers"               => "XLF"
    "Specialty Insurance"               => "XLF"
    "Property/Casualty Insurance"       => "XLF"
    "Savings Banks"                     => "XLF"
    "Insurance Brokers/Services"        => "XLF"


    "Oil & Gas"                         => "XLE"
    "Oil & Gas Production"              => "XLE"
    "Oilfield Services"                 => "XLE"
    "Oilfield Services/Equipment"       => "XLE"
    "Oil Refining/Marketing"            => "XLE"
    "Contract Drilling"                 => "XLE"
    "Oil & Gas Pipelines"               => "XLE"
    "Integrated Oil"                    => "XLE"
    "Coal"                              => "XLE"

    "Aerospace & Defense"               => "XLI"
    "Industrial Machinery"              => "XLI"
    "Electrical Products"               => "XLI"
    "Railroads"                         => "XLI"
    "Pulp & Paper"                      => "XLI"
    "Electronic Production Equipment"   => "XLI"
    "Office Equipment/Supplies"         => "XLI"
    "Industrial Conglomerates"          => "XLI"
    "Miscellaneous Manufacturing"       => "XLI"
    "Air Freight/Couriers"              => "XLI"    
    "Metal Fabrication"                 => "XLI"
    "Miscellaneous Manufacturing"       => "XLI"
    "Construction"                      => "XLI"
    "Environmental Services"            => "XLI"
    "Finance/Rental/Leasing"            => "XLI"
    "Tools & Hardware"                  => "XLI"
    "Transportation"                    => "XLI"
    "Industrial Specialties"            => "XLI"
    "Trucking"                          => "XLI"
    "Other Metals/Minerals"             => "XLI"
    "Trucks/Construction/Farm Machinery" => "XLI"
    "Airlines"                          => "XLI"
    "Wholesale Distributors"            => "XLI"
    "Marine Shipping"                   => "XLI"
    "Motor Vehicles"                    => "XLI"
    "Forest Products"                   => "XLI"

    "Chemicals"                         => "XLB"
    "Metals & Mining"                   => "XLB"
    "Chemicals: Specialty"              => "XLB"
    "Steel"                             => "XLB"
    "Food: Specialty/Candy"             => "XLB"
    "Paper & Forest Products"           => "XLB"
    "Construction Materials"            => "XLB"
    "Aluminum"                          => "XLB"
    "Precious Metals"                   => "XLB"
    "Chemicals: Major Diversified"      => "XLB"
    "Chemicals: Agricultural"           => "XLB"

    "Real Estate Development"           => "XLRE"
    "Real Estate Investment Trusts"     => "XLRE"

    "Utilities"                         => "XLU"
    "Electric Utilities"                => "XLU"
    "Water Utilities"                   => "XLU"
    "Gas Distributors"                  => "XLU"
    "Alternative Power Generation"      => "XLU"

    "Investment Trusts/Mutual Funds"    => "XLE"
    => "UNKNOWN"



// Final Sector (Override > Industry)
_spdr = gicsOverride != "" ? gicsOverride : _spdr_industry

//  Display
var table corner = table.new(position.bottom_right, 1, 1, border_width = 1)
if barstate.islast
    table.cell(corner, 0, 0, _spdr, text_color=color.white, text_size=size.large)
